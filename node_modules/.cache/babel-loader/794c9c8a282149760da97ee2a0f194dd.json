{"ast":null,"code":"import { useCallback, useLayoutEffect, useRef, useState } from 'react';\nimport { useMessageListScrollManager } from './useMessageListScrollManager';\nexport var useScrollLocationLogic = function (params) {\n  var _a = params.messages,\n    messages = _a === void 0 ? [] : _a,\n    _b = params.scrolledUpThreshold,\n    scrolledUpThreshold = _b === void 0 ? 200 : _b;\n  var _c = useState(false),\n    hasNewMessages = _c[0],\n    setHasNewMessages = _c[1];\n  var _d = useState(),\n    wrapperRect = _d[0],\n    setWrapperRect = _d[1];\n  var closeToBottom = useRef(false);\n  var closeToTop = useRef(false);\n  var listRef = useRef(null);\n  var scrollToBottom = useCallback(function () {\n    var _a, _b;\n    if (!((_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollTo)) return;\n    (_b = listRef.current) === null || _b === void 0 ? void 0 : _b.scrollTo({\n      top: listRef.current.scrollHeight\n    });\n    setHasNewMessages(false);\n    // this is hacky and unreliable, but that was the current implementation so not breaking it\n    setTimeout(function () {\n      var _a;\n      (_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollTo({\n        top: listRef.current.scrollHeight\n      });\n    }, 200);\n  }, [listRef]);\n  useLayoutEffect(function () {\n    if (listRef === null || listRef === void 0 ? void 0 : listRef.current) {\n      setWrapperRect(listRef.current.getBoundingClientRect());\n      scrollToBottom();\n    }\n  }, [listRef]);\n  var updateScrollTop = useMessageListScrollManager({\n    messages: messages,\n    onScrollBy: function (scrollBy) {\n      var _a;\n      return (_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollBy({\n        top: scrollBy\n      });\n    },\n    scrollContainerMeasures: function () {\n      var _a, _b;\n      return {\n        offsetHeight: ((_a = listRef.current) === null || _a === void 0 ? void 0 : _a.offsetHeight) || 0,\n        scrollHeight: ((_b = listRef.current) === null || _b === void 0 ? void 0 : _b.scrollHeight) || 0\n      };\n    },\n    scrolledUpThreshold: scrolledUpThreshold,\n    scrollToBottom: scrollToBottom,\n    showNewMessages: function () {\n      return setHasNewMessages(true);\n    }\n  });\n  var onScroll = useCallback(function (event) {\n    var element = event.target;\n    var scrollTop = element.scrollTop;\n    updateScrollTop(scrollTop);\n    var offsetHeight = element.offsetHeight;\n    var scrollHeight = element.scrollHeight;\n    closeToBottom.current = scrollHeight - (scrollTop + offsetHeight) < scrolledUpThreshold;\n    closeToTop.current = scrollTop < scrolledUpThreshold;\n    if (closeToBottom.current) {\n      setHasNewMessages(false);\n    }\n  }, [updateScrollTop, closeToTop, closeToBottom, scrolledUpThreshold]);\n  var onMessageLoadCaptured = useCallback(function () {\n    /**\n     * A load event (emitted by e.g. an <img>) was captured on a message.\n     * In some cases, the loaded asset is larger than the placeholder, which means we have to scroll down.\n     */\n    if (closeToBottom.current && !closeToTop.current) {\n      scrollToBottom();\n    }\n  }, [closeToTop, closeToBottom, scrollToBottom]);\n  return {\n    hasNewMessages: hasNewMessages,\n    listRef: listRef,\n    onMessageLoadCaptured: onMessageLoadCaptured,\n    onScroll: onScroll,\n    scrollToBottom: scrollToBottom,\n    wrapperRect: wrapperRect\n  };\n};","map":{"version":3,"names":["useCallback","useLayoutEffect","useRef","useState","useMessageListScrollManager","useScrollLocationLogic","params","_a","messages","_b","scrolledUpThreshold","_c","hasNewMessages","setHasNewMessages","_d","wrapperRect","setWrapperRect","closeToBottom","closeToTop","listRef","scrollToBottom","current","scrollTo","top","scrollHeight","setTimeout","getBoundingClientRect","updateScrollTop","onScrollBy","scrollBy","scrollContainerMeasures","offsetHeight","showNewMessages","onScroll","event","element","target","scrollTop","onMessageLoadCaptured"],"sources":["C:/Users/HP/Desktop/project_medical_pager_chat-master/node_modules/stream-chat-react/dist/components/MessageList/hooks/useScrollLocationLogic.js"],"sourcesContent":["import { useCallback, useLayoutEffect, useRef, useState } from 'react';\nimport { useMessageListScrollManager } from './useMessageListScrollManager';\nexport var useScrollLocationLogic = function (params) {\n    var _a = params.messages, messages = _a === void 0 ? [] : _a, _b = params.scrolledUpThreshold, scrolledUpThreshold = _b === void 0 ? 200 : _b;\n    var _c = useState(false), hasNewMessages = _c[0], setHasNewMessages = _c[1];\n    var _d = useState(), wrapperRect = _d[0], setWrapperRect = _d[1];\n    var closeToBottom = useRef(false);\n    var closeToTop = useRef(false);\n    var listRef = useRef(null);\n    var scrollToBottom = useCallback(function () {\n        var _a, _b;\n        if (!((_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollTo))\n            return;\n        (_b = listRef.current) === null || _b === void 0 ? void 0 : _b.scrollTo({\n            top: listRef.current.scrollHeight,\n        });\n        setHasNewMessages(false);\n        // this is hacky and unreliable, but that was the current implementation so not breaking it\n        setTimeout(function () {\n            var _a;\n            (_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollTo({\n                top: listRef.current.scrollHeight,\n            });\n        }, 200);\n    }, [listRef]);\n    useLayoutEffect(function () {\n        if (listRef === null || listRef === void 0 ? void 0 : listRef.current) {\n            setWrapperRect(listRef.current.getBoundingClientRect());\n            scrollToBottom();\n        }\n    }, [listRef]);\n    var updateScrollTop = useMessageListScrollManager({\n        messages: messages,\n        onScrollBy: function (scrollBy) { var _a; return (_a = listRef.current) === null || _a === void 0 ? void 0 : _a.scrollBy({ top: scrollBy }); },\n        scrollContainerMeasures: function () {\n            var _a, _b;\n            return ({\n                offsetHeight: ((_a = listRef.current) === null || _a === void 0 ? void 0 : _a.offsetHeight) || 0,\n                scrollHeight: ((_b = listRef.current) === null || _b === void 0 ? void 0 : _b.scrollHeight) || 0,\n            });\n        },\n        scrolledUpThreshold: scrolledUpThreshold,\n        scrollToBottom: scrollToBottom,\n        showNewMessages: function () { return setHasNewMessages(true); },\n    });\n    var onScroll = useCallback(function (event) {\n        var element = event.target;\n        var scrollTop = element.scrollTop;\n        updateScrollTop(scrollTop);\n        var offsetHeight = element.offsetHeight;\n        var scrollHeight = element.scrollHeight;\n        closeToBottom.current = scrollHeight - (scrollTop + offsetHeight) < scrolledUpThreshold;\n        closeToTop.current = scrollTop < scrolledUpThreshold;\n        if (closeToBottom.current) {\n            setHasNewMessages(false);\n        }\n    }, [updateScrollTop, closeToTop, closeToBottom, scrolledUpThreshold]);\n    var onMessageLoadCaptured = useCallback(function () {\n        /**\n         * A load event (emitted by e.g. an <img>) was captured on a message.\n         * In some cases, the loaded asset is larger than the placeholder, which means we have to scroll down.\n         */\n        if (closeToBottom.current && !closeToTop.current) {\n            scrollToBottom();\n        }\n    }, [closeToTop, closeToBottom, scrollToBottom]);\n    return {\n        hasNewMessages: hasNewMessages,\n        listRef: listRef,\n        onMessageLoadCaptured: onMessageLoadCaptured,\n        onScroll: onScroll,\n        scrollToBottom: scrollToBottom,\n        wrapperRect: wrapperRect,\n    };\n};\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,eAAe,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACtE,SAASC,2BAA2B,QAAQ,+BAA+B;AAC3E,OAAO,IAAIC,sBAAsB,GAAG,SAAAA,CAAUC,MAAM,EAAE;EAClD,IAAIC,EAAE,GAAGD,MAAM,CAACE,QAAQ;IAAEA,QAAQ,GAAGD,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,EAAE;IAAEE,EAAE,GAAGH,MAAM,CAACI,mBAAmB;IAAEA,mBAAmB,GAAGD,EAAE,KAAK,KAAK,CAAC,GAAG,GAAG,GAAGA,EAAE;EAC7I,IAAIE,EAAE,GAAGR,QAAQ,CAAC,KAAK,CAAC;IAAES,cAAc,GAAGD,EAAE,CAAC,CAAC,CAAC;IAAEE,iBAAiB,GAAGF,EAAE,CAAC,CAAC,CAAC;EAC3E,IAAIG,EAAE,GAAGX,QAAQ,CAAC,CAAC;IAAEY,WAAW,GAAGD,EAAE,CAAC,CAAC,CAAC;IAAEE,cAAc,GAAGF,EAAE,CAAC,CAAC,CAAC;EAChE,IAAIG,aAAa,GAAGf,MAAM,CAAC,KAAK,CAAC;EACjC,IAAIgB,UAAU,GAAGhB,MAAM,CAAC,KAAK,CAAC;EAC9B,IAAIiB,OAAO,GAAGjB,MAAM,CAAC,IAAI,CAAC;EAC1B,IAAIkB,cAAc,GAAGpB,WAAW,CAAC,YAAY;IACzC,IAAIO,EAAE,EAAEE,EAAE;IACV,IAAI,EAAE,CAACF,EAAE,GAAGY,OAAO,CAACE,OAAO,MAAM,IAAI,IAAId,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACe,QAAQ,CAAC,EAC1E;IACJ,CAACb,EAAE,GAAGU,OAAO,CAACE,OAAO,MAAM,IAAI,IAAIZ,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACa,QAAQ,CAAC;MACpEC,GAAG,EAAEJ,OAAO,CAACE,OAAO,CAACG;IACzB,CAAC,CAAC;IACFX,iBAAiB,CAAC,KAAK,CAAC;IACxB;IACAY,UAAU,CAAC,YAAY;MACnB,IAAIlB,EAAE;MACN,CAACA,EAAE,GAAGY,OAAO,CAACE,OAAO,MAAM,IAAI,IAAId,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACe,QAAQ,CAAC;QACpEC,GAAG,EAAEJ,OAAO,CAACE,OAAO,CAACG;MACzB,CAAC,CAAC;IACN,CAAC,EAAE,GAAG,CAAC;EACX,CAAC,EAAE,CAACL,OAAO,CAAC,CAAC;EACblB,eAAe,CAAC,YAAY;IACxB,IAAIkB,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACE,OAAO,EAAE;MACnEL,cAAc,CAACG,OAAO,CAACE,OAAO,CAACK,qBAAqB,CAAC,CAAC,CAAC;MACvDN,cAAc,CAAC,CAAC;IACpB;EACJ,CAAC,EAAE,CAACD,OAAO,CAAC,CAAC;EACb,IAAIQ,eAAe,GAAGvB,2BAA2B,CAAC;IAC9CI,QAAQ,EAAEA,QAAQ;IAClBoB,UAAU,EAAE,SAAAA,CAAUC,QAAQ,EAAE;MAAE,IAAItB,EAAE;MAAE,OAAO,CAACA,EAAE,GAAGY,OAAO,CAACE,OAAO,MAAM,IAAI,IAAId,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACsB,QAAQ,CAAC;QAAEN,GAAG,EAAEM;MAAS,CAAC,CAAC;IAAE,CAAC;IAC9IC,uBAAuB,EAAE,SAAAA,CAAA,EAAY;MACjC,IAAIvB,EAAE,EAAEE,EAAE;MACV,OAAQ;QACJsB,YAAY,EAAE,CAAC,CAACxB,EAAE,GAAGY,OAAO,CAACE,OAAO,MAAM,IAAI,IAAId,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACwB,YAAY,KAAK,CAAC;QAChGP,YAAY,EAAE,CAAC,CAACf,EAAE,GAAGU,OAAO,CAACE,OAAO,MAAM,IAAI,IAAIZ,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACe,YAAY,KAAK;MACnG,CAAC;IACL,CAAC;IACDd,mBAAmB,EAAEA,mBAAmB;IACxCU,cAAc,EAAEA,cAAc;IAC9BY,eAAe,EAAE,SAAAA,CAAA,EAAY;MAAE,OAAOnB,iBAAiB,CAAC,IAAI,CAAC;IAAE;EACnE,CAAC,CAAC;EACF,IAAIoB,QAAQ,GAAGjC,WAAW,CAAC,UAAUkC,KAAK,EAAE;IACxC,IAAIC,OAAO,GAAGD,KAAK,CAACE,MAAM;IAC1B,IAAIC,SAAS,GAAGF,OAAO,CAACE,SAAS;IACjCV,eAAe,CAACU,SAAS,CAAC;IAC1B,IAAIN,YAAY,GAAGI,OAAO,CAACJ,YAAY;IACvC,IAAIP,YAAY,GAAGW,OAAO,CAACX,YAAY;IACvCP,aAAa,CAACI,OAAO,GAAGG,YAAY,IAAIa,SAAS,GAAGN,YAAY,CAAC,GAAGrB,mBAAmB;IACvFQ,UAAU,CAACG,OAAO,GAAGgB,SAAS,GAAG3B,mBAAmB;IACpD,IAAIO,aAAa,CAACI,OAAO,EAAE;MACvBR,iBAAiB,CAAC,KAAK,CAAC;IAC5B;EACJ,CAAC,EAAE,CAACc,eAAe,EAAET,UAAU,EAAED,aAAa,EAAEP,mBAAmB,CAAC,CAAC;EACrE,IAAI4B,qBAAqB,GAAGtC,WAAW,CAAC,YAAY;IAChD;AACR;AACA;AACA;IACQ,IAAIiB,aAAa,CAACI,OAAO,IAAI,CAACH,UAAU,CAACG,OAAO,EAAE;MAC9CD,cAAc,CAAC,CAAC;IACpB;EACJ,CAAC,EAAE,CAACF,UAAU,EAAED,aAAa,EAAEG,cAAc,CAAC,CAAC;EAC/C,OAAO;IACHR,cAAc,EAAEA,cAAc;IAC9BO,OAAO,EAAEA,OAAO;IAChBmB,qBAAqB,EAAEA,qBAAqB;IAC5CL,QAAQ,EAAEA,QAAQ;IAClBb,cAAc,EAAEA,cAAc;IAC9BL,WAAW,EAAEA;EACjB,CAAC;AACL,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}